<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#8b5cf6">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="赚钱助手">
    <title>赚钱软件管理系统</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="icon-192x192.png">
    <!-- Chart.js for data visualization -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <!-- 导航栏 -->
    <nav class="navbar">
        <div class="nav-title">赚钱软件管理系统</div>
    </nav>

    <!-- 主内容区域 -->
    <main class="main-content">
        <!-- 仪表盘页面 -->
        <div class="page active" id="page-dashboard">
            <div class="date-container">
                <span class="current-date" id="current-date"></span>
            </div>

            <!-- 全局搜索 -->
            <div class="card mb-4">
                <div class="search-container" style="display: flex; gap: 12px; align-items: center;">
                    <div class="search-input-wrapper" style="flex: 1; position: relative;">
                        <input type="text" id="global-search" class="form-input" placeholder="🔍 搜索手机、软件..." oninput="performSearch(this.value)">
                        <div id="search-results" class="search-results-dropdown" style="display: none; position: absolute; top: 100%; left: 0; right: 0; background: var(--bg-secondary); border: 1px solid var(--border-color); border-radius: var(--radius-md); margin-top: 8px; max-height: 300px; overflow-y: auto; z-index: 100; box-shadow: var(--shadow-card);"></div>
                    </div>
                    <button class="btn btn-secondary" onclick="clearSearch()">清除</button>
                </div>
            </div>

            <!-- 统计卡片 -->
            <div class="stats-container">
                <div class="stats-row">
                    <div class="stat-card border-primary animate-border">
                        <i></i><i></i>
                        <span class="stat-label">总手机数</span>
                        <span class="stat-value" id="total-phones">0</span>
                    </div>
                    <div class="stat-card border-secondary animate-border">
                        <i></i><i></i>
                        <span class="stat-label">总软件数</span>
                        <span class="stat-value" id="total-apps">0</span>
                    </div>
                </div>
                <div class="stats-row">
                    <div class="stat-card border-tertiary animate-border">
                        <i></i><i></i>
                        <span class="stat-label">待支出余额</span>
                        <span class="stat-value" id="total-balance">¥0.00</span>
                    </div>
                    <div class="stat-card border-accent animate-border">
                        <i></i><i></i>
                        <span class="stat-label">待提现软件</span>
                        <span class="stat-value" id="ready-apps">0</span>
                    </div>
                </div>
            </div>

            <!-- 智能建议助手 -->
            <div class="card mt-4" id="smart-suggestions-card" style="display: none;">
                <div class="section-header">
                    <div class="section-title">💡 智能建议</div>
                    <div class="section-divider"></div>
                </div>
                <div id="smart-suggestions-content">
                    <!-- 建议内容将由JS生成 -->
                </div>
            </div>

            <!-- 收入预测 -->
            <div class="card mt-4" id="income-prediction-card" style="display: none;">
                <div class="section-header">
                    <div class="section-title">📊 收入预测</div>
                    <div class="section-divider"></div>
                </div>
                <div id="income-prediction-content">
                    <!-- 预测内容将由JS生成 -->
                </div>
            </div>

            <!-- 软件收益排行 -->
            <div class="card mt-4" id="app-ranking-card" style="display: none;">
                <div class="section-header">
                    <div class="section-title">🏆 软件收益排行</div>
                    <div class="section-divider"></div>
                </div>
                <div id="app-ranking-content">
                    <!-- 排行内容将由JS生成 -->
                </div>
            </div>

            <!-- 全年目标 -->
            <div class="goal-card animate-border">
                <i></i><i></i>
                <div class="section-title">全年目标达成情况</div>
                <div class="progress-item">
                    <div class="progress-header">
                        <span>总目标</span>
                        <span class="font-semibold" id="yearly-progress">0%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="yearly-progress-bar" style="width: 0%"></div>
                    </div>
                </div>
            </div>

            <!-- 用户等级和签到 -->
            <div class="card mt-4" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
                <div class="section-header">
                    <div class="section-title" style="color: white;">🏆 我的成就</div>
                    <div class="section-divider" style="background: rgba(255,255,255,0.3);"></div>
                </div>
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                    <div>
                        <div style="font-size: 24px; font-weight: bold;" id="user-level-title">Lv.1 新手</div>
                        <div style="font-size: 12px; opacity: 0.9; margin-top: 4px;" id="user-exp">经验值: 0/100</div>
                    </div>
                    <button class="btn" id="checkin-btn" onclick="doDailyCheckIn()" style="background: white; color: #667eea; font-weight: bold;">每日签到</button>
                </div>
                <div style="display: flex; gap: 16px; font-size: 14px;">
                    <div>🔥 连续签到: <span id="consecutive-days">0</span>天</div>
                    <div>📅 累计签到: <span id="total-checkin-days">0</span>天</div>
                </div>
                <div class="progress-item" style="margin-top: 12px;">
                    <div class="progress-bar" style="background: rgba(255,255,255,0.3);">
                        <div class="progress-fill" id="exp-progress-bar" style="width: 0%; background: white;"></div>
                    </div>
                </div>
            </div>

            <!-- 收入趋势图表 -->
            <div class="card mt-4">
                <div class="section-header">
                    <div class="section-title">📈 收入趋势</div>
                    <div class="section-divider"></div>
                </div>
                <div style="margin-bottom: 16px;">
                    <canvas id="incomeChart" style="max-height: 300px;"></canvas>
                </div>
                <div class="flex gap-4 justify-center">
                    <button class="btn btn-secondary" onclick="updateChartPeriod('week')">近7天</button>
                    <button class="btn btn-secondary" onclick="updateChartPeriod('month')">近30天</button>
                    <button class="btn btn-secondary" onclick="updateChartPeriod('year')">全年</button>
                </div>
            </div>

            <!-- 收入日历 -->
            <div class="card mt-4">
                <div class="section-header">
                    <div class="section-title">📅 收入日历</div>
                    <div class="section-divider"></div>
                </div>
                <div class="calendar-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                    <button class="btn btn-secondary" onclick="changeCalendarMonth(-1)">◀</button>
                    <span id="calendar-month-year" style="font-weight: 600; font-size: 18px;"></span>
                    <button class="btn btn-secondary" onclick="changeCalendarMonth(1)">▶</button>
                </div>
                <div class="calendar-grid" id="income-calendar" style="display: grid; grid-template-columns: repeat(7, 1fr); gap: 8px;">
                    <!-- 日历将由JS生成 -->
                </div>
                <div class="calendar-legend" style="margin-top: 16px; display: flex; gap: 16px; justify-content: center; flex-wrap: wrap;">
                    <div style="display: flex; align-items: center; gap: 6px;"><div style="width: 16px; height: 16px; background: #dcfce7; border-radius: 4px;"></div><span style="font-size: 12px;">有收入</span></div>
                    <div style="display: flex; align-items: center; gap: 6px;"><div style="width: 16px; height: 16px; background: #fee2e2; border-radius: 4px;"></div><span style="font-size: 12px;">有支出</span></div>
                    <div style="display: flex; align-items: center; gap: 6px;"><div style="width: 16px; height: 16px; background: #dbeafe; border-radius: 4px;"></div><span style="font-size: 12px;">有提现</span></div>
                    <div style="display: flex; align-items: center; gap: 6px;"><div style="width: 16px; height: 16px; background: #fef3c7; border-radius: 4px;"></div><span style="font-size: 12px;">还款日</span></div>
                </div>
            </div>

            <!-- 每日任务 -->
            <div class="card mt-4">
                <div class="section-header">
                    <div class="section-title">📋 每日任务</div>
                    <div class="section-divider"></div>
                </div>
                <div id="daily-tasks-list">
                    <div class="empty-state" id="daily-tasks-empty">
                        <div class="empty-state-illustration">📋</div>
                        <div class="empty-state-title">暂无每日任务</div>
                        <div class="empty-state-description">完成任务可以获得经验值和成就</div>
                    </div>
                </div>
            </div>

            <!-- 今日需要关注的软件 -->
            <div class="section-title">今日需要关注的软件</div>
            <div class="app-list" id="today-apps-list">
                <!-- 空状态将由JS动态生成 -->
            </div>
        </div>

        <!-- 手机管理页面 -->
        <div class="page" id="page-phones">
            <div class="date-container">
                <span class="current-date" id="phones-current-date"></span>
            </div>

            <div class="flex gap-4 w-full">
                <button class="btn btn-primary flex-1" onclick="openAddPhoneModal()">添加手机</button>
                <button class="btn btn-secondary flex-1" onclick="showPage('withdraw-records')">提现记录</button>
            </div>

            <div class="card mt-4">
                <div class="section-header">
                    <div class="section-title">📱 手机抽签</div>
                    <div class="section-divider"></div>
                </div>
                <div class="form-hint mb-4">随机抽取手机决定玩机顺序，并展示每台手机中软件的玩机顺序</div>
                <div class="flex gap-4">
                    <button class="btn btn-accent flex-1" onclick="startPhoneDraw()">开始手机抽签</button>
                    <button class="btn btn-secondary flex-1" onclick="showPhoneDrawHistory()">抽签历史</button>
                </div>
            </div>

            <div class="phone-grid" id="phone-grid">
                <!-- 空状态将由JS动态生成 -->
            </div>
        </div>

        <!-- 统计分析页面 -->
        <div class="page" id="page-stats">
            <div class="date-container">
                <span class="current-date" id="stats-current-date"></span>
            </div>

            <div class="section-header">
                <div class="section-title">提现与收入统计</div>
                <div class="section-divider"></div>
            </div>

            <div class="stats-grid">
                <div class="stats-row">
                    <div class="stat-card primary animate-border">
                        <i></i><i></i>
                        <span class="stat-label">已赚金额</span>
                        <span class="stat-value large" id="stats-total-earned">¥0.00</span>
                    </div>
                    <div class="stat-card secondary animate-border">
                        <i></i><i></i>
                        <span class="stat-label">已提金额</span>
                        <span class="stat-value" id="stats-total-withdrawn">¥0.00</span>
                    </div>
                    <div class="stat-card tertiary animate-border">
                        <i></i><i></i>
                        <span class="stat-label">支出金额</span>
                        <span class="stat-value" id="stats-total-expenses">¥0.00</span>
                    </div>
                </div>
                <div class="stats-row">
                    <div class="stat-card primary animate-border">
                        <i></i><i></i>
                        <span class="stat-label">剩余余额</span>
                        <span class="stat-value large" id="stats-total-balance">¥0.00</span>
                    </div>
                    <div class="stat-card secondary animate-border">
                        <i></i><i></i>
                        <span class="stat-label">提现率</span>
                        <span class="stat-value" id="stats-withdraw-rate">0%</span>
                    </div>
                    <div class="stat-card tertiary animate-border">
                        <i></i><i></i>
                        <span class="stat-label">支出率</span>
                        <span class="stat-value" id="stats-expense-rate">0%</span>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="section-header">
                    <div class="section-title">各软件提现与收入情况</div>
                    <div class="section-divider"></div>
                </div>
                <div class="app-withdraw-list" id="app-withdraw-list">
                    <div class="empty-state">暂无软件数据</div>
                </div>
            </div>
        </div>

        <!-- 提前计算页面 -->
        <div class="page" id="page-forecast">
            <div class="date-container">
                <span class="current-date" id="forecast-current-date"></span>
            </div>

            <div class="card">
                <div class="setting-item">
                    <label class="form-label">目标日期</label>
                    <div class="date-input-container flex gap-4 items-center">
                        <input type="date" id="target-date" class="form-input flex-1" min="2026-01-01">
                        <button class="btn btn-primary" onclick="calculateForecast()">计算</button>
                    </div>
                </div>
            </div>

            <div class="forecast-result mt-6" id="forecast-result" style="display: none;">
                <div class="card">
                    <div class="result-header">
                        <div class="result-title text-xl font-semibold mb-4">计算结果</div>
                        <div class="block mb-1" id="forecast-days-info"></div>
                        <div class="block mb-4 font-medium" id="forecast-total-needed"></div>
                    </div>
                    <div class="app-list" id="forecast-app-list"></div>
                </div>
            </div>
            <div class="empty-state" id="forecast-empty">
                请选择目标日期并点击计算按钮
            </div>
        </div>

        <!-- 游戏管理页面 -->
        <div class="page" id="page-games">
            <div class="date-container">
                <span class="current-date" id="games-current-date"></span>
            </div>

            <!-- 今日游戏抽签 -->
            <div class="card" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
                <div class="section-header">
                    <div class="section-title" style="color: white;">🎲 今日游戏抽签</div>
                    <div class="section-divider" style="background: rgba(255,255,255,0.3);"></div>
                </div>
                <div id="today-game-result" style="text-align: center; padding: 20px;">
                    <div style="font-size: 18px; margin-bottom: 16px;">点击下方按钮抽签决定今天玩哪个游戏</div>
                    <button class="btn" onclick="drawTodayGame()" style="background: white; color: #667eea; font-weight: bold; font-size: 16px;">🎮 开始抽签</button>
                </div>
            </div>

            <!-- 手机选择 -->
            <div class="card mt-4">
                <div class="section-header">
                    <div class="section-title">📱 选择手机</div>
                    <div class="section-divider"></div>
                </div>
                <div class="form-group">
                    <label class="form-label">当前手机</label>
                    <select id="game-phone-select" class="form-input" onchange="onGamePhoneChange()">
                        <option value="">全部手机</option>
                    </select>
                </div>
            </div>

            <!-- 添加新游戏 -->
            <div class="card mt-4">
                <div class="section-header">
                    <div class="section-title">➕ 添加新游戏</div>
                    <div class="section-divider"></div>
                </div>
                <div class="form-group">
                    <label class="form-label">游戏名称</label>
                    <input type="text" id="new-game-name" class="form-input" placeholder="输入游戏名称">
                </div>
                <button class="btn btn-primary w-full" onclick="addNewGame()">添加游戏</button>
            </div>

            <!-- 游戏统计 -->
            <div class="card mt-4">
                <div class="section-header">
                    <div class="section-title">📊 游戏统计</div>
                    <div class="section-divider"></div>
                </div>
                <div id="phone-game-stats">
                    <!-- 动态生成各手机统计 -->
                </div>
            </div>

            <!-- 游戏列表 -->
            <div class="card mt-4">
                <div class="section-header">
                    <div class="section-title">🎮 游戏列表</div>
                    <div class="section-divider"></div>
                </div>
                <div id="games-list">
                    <div class="empty-state">暂无游戏，请添加新游戏</div>
                </div>
            </div>

            <!-- 抽签历史 -->
            <div class="card mt-4">
                <div class="section-header">
                    <div class="section-title">📜 抽签历史</div>
                    <div class="section-divider"></div>
                </div>
                <div id="game-draw-history">
                    <div class="empty-state">暂无抽签记录</div>
                </div>
            </div>
        </div>

        <!-- 设置页面 -->
        <div class="page" id="page-settings">
            <div class="date-container">
                <span class="current-date" id="settings-current-date"></span>
            </div>

            <div class="card">
                <div class="section-header">
                    <div class="section-title">全年目标金额</div>
                    <div class="section-divider"></div>
                </div>
                <div class="setting-item">
                    <div class="goal-input-container">
                        <input type="number" id="yearly-goal" class="form-input" placeholder="请输入全年目标金额">
                        <span class="year-days-hint" id="year-days-hint"></span>
                    </div>
                </div>
            </div>

            <div class="card mt-6">
                <div class="section-header">
                    <div class="section-title">主题风格</div>
                    <div class="section-divider"></div>
                </div>
                <div class="form-hint mb-4">选择你喜欢的主题风格，一键切换界面配色</div>
                <div class="theme-selector" id="theme-selector">
                    <div class="theme-item" data-theme="default" onclick="setTheme('default')">
                        <div class="theme-preview theme-preview-default"></div>
                        <span class="theme-name">梦幻紫</span>
                    </div>
                    <div class="theme-item" data-theme="youth-green" onclick="setTheme('youth-green')">
                        <div class="theme-preview theme-preview-youth-green"></div>
                        <span class="theme-name">青春绿</span>
                    </div>
                    <div class="theme-item" data-theme="vitality-orange" onclick="setTheme('vitality-orange')">
                        <div class="theme-preview theme-preview-vitality-orange"></div>
                        <span class="theme-name">活力橙</span>
                    </div>
                    <div class="theme-item" data-theme="ocean-blue" onclick="setTheme('ocean-blue')">
                        <div class="theme-preview theme-preview-ocean-blue"></div>
                        <span class="theme-name">海洋蓝</span>
                    </div>
                    <div class="theme-item" data-theme="sweet-pink" onclick="setTheme('sweet-pink')">
                        <div class="theme-preview theme-preview-sweet-pink"></div>
                        <span class="theme-name">甜美粉</span>
                    </div>
                    <div class="theme-item" data-theme="warm-sunset" onclick="setTheme('warm-sunset')">
                        <div class="theme-preview theme-preview-warm-sunset"></div>
                        <span class="theme-name">温暖夕阳</span>
                    </div>
                    <div class="theme-item" data-theme="minimal-dark" onclick="setTheme('minimal-dark')">
                        <div class="theme-preview theme-preview-minimal-dark"></div>
                        <span class="theme-name">极简黑白</span>
                    </div>
                    <div class="theme-item" data-theme="morandi" onclick="setTheme('morandi')">
                        <div class="theme-preview theme-preview-morandi"></div>
                        <span class="theme-name">莫兰迪色</span>
                    </div>
                    <div class="theme-item" data-theme="forest" onclick="setTheme('forest')">
                        <div class="theme-preview theme-preview-forest"></div>
                        <span class="theme-name">森林自然</span>
                    </div>
                    <div class="theme-item" data-theme="business" onclick="setTheme('business')">
                        <div class="theme-preview theme-preview-business"></div>
                        <span class="theme-name">极简商务风</span>
                    </div>
                    <div class="theme-item" data-theme="dark" onclick="setTheme('dark')">
                        <div class="theme-preview theme-preview-dark"></div>
                        <span class="theme-name">暗黑模式</span>
                    </div>
                </div>
            </div>

            <div class="card mt-6">
                <div class="section-header">
                    <div class="section-title">📊 数据管理中心</div>
                    <div class="section-divider"></div>
                </div>
                
                <!-- 数据备份与恢复 -->
                <div class="data-section mb-6">
                    <div class="section-subtitle" style="font-size: 14px; color: var(--text-secondary); margin-bottom: 12px; font-weight: 600;">💾 数据备份与恢复</div>
                    <div class="form-hint mb-3" style="font-size: 13px;">JSON格式包含所有数据，用于完整备份和恢复</div>
                    <div class="data-management-buttons flex gap-3 mb-3">
                        <button class="btn btn-primary flex-1" onclick="exportJSON()">📥 导出JSON</button>
                        <button class="btn btn-secondary flex-1" onclick="importJSON()">📤 导入JSON</button>
                    </div>
                    <div class="data-management-buttons">
                        <button class="btn btn-primary w-full" onclick="exportData()">📊 导出Excel</button>
                    </div>
                </div>

                <!-- 日期模拟测试 -->
                <div class="data-section mb-6" style="padding-top: 16px; border-top: 1px solid var(--border-color);">
                    <div class="section-subtitle" style="font-size: 14px; color: var(--text-secondary); margin-bottom: 12px; font-weight: 600;">📅 日期模拟测试</div>
                    <div class="form-hint mb-3" style="font-size: 13px;">模拟不同日期，验证每日赚取计算是否正确</div>
                    <div class="form-group mb-3">
                        <label class="form-label" style="font-size: 13px;">模拟日期</label>
                        <input type="date" id="simulated-date" class="form-input">
                    </div>
                    <div class="form-group mb-3">
                        <label class="form-label" style="font-size: 13px;">当前状态</label>
                        <div id="simulation-status" style="padding: 10px; background: var(--card-bg); border-radius: var(--radius-md); border: 1px solid var(--border-color); font-size: 13px;">
                            <span style="color: var(--text-secondary);">使用真实日期</span>
                        </div>
                    </div>
                    <div class="data-management-buttons flex gap-3 mb-3">
                        <button class="btn btn-primary flex-1" onclick="applyDateSimulation()">✅ 应用</button>
                        <button class="btn btn-secondary flex-1" onclick="resetDateSimulation()">🔄 重置</button>
                    </div>
                    <div id="simulation-preview" style="display: none;">
                        <div style="font-weight: 600; margin-bottom: 8px; font-size: 13px;">模拟效果预览</div>
                        <div id="simulation-preview-content" style="padding: 10px; background: var(--card-bg); border-radius: var(--radius-md); border: 1px solid var(--border-color); font-size: 12px;"></div>
                    </div>
                </div>

                <!-- 批量操作 -->
                <div class="data-section mb-6" style="padding-top: 16px; border-top: 1px solid var(--border-color);">
                    <div class="section-subtitle" style="font-size: 14px; color: var(--text-secondary); margin-bottom: 12px; font-weight: 600;">⚡ 批量操作</div>
                    
                    <!-- 批量添加手机 -->
                    <div class="mb-4">
                        <div class="form-hint mb-2" style="font-size: 13px;">批量添加手机（每行一个名称）</div>
                        <textarea id="bulk-phone-names" class="form-input mb-2" rows="3" placeholder="手机1&#10;手机2&#10;手机3" style="font-size: 13px;"></textarea>
                        <button class="btn btn-primary w-full" onclick="bulkAddPhones()">📱 批量添加手机</button>
                    </div>
                    
                    <!-- 批量添加软件 -->
                    <div style="padding-top: 12px; border-top: 1px dashed var(--border-color);">
                        <div class="form-hint mb-2" style="font-size: 13px;">批量添加软件到所有手机</div>
                        <textarea id="bulk-app-names" class="form-input mb-2" rows="3" placeholder="抖音极速版&#10;快手极速版&#10;百度极速版" style="font-size: 13px;"></textarea>
                        <div class="form-group mb-2">
                            <label class="form-label" style="font-size: 12px;">默认最小提现金额 (元)</label>
                            <input type="number" id="bulk-app-min-withdraw" class="form-input" value="0.3" step="0.01" style="font-size: 13px;">
                        </div>
                        <button class="btn btn-primary w-full" onclick="bulkAddApps()">📲 批量添加软件</button>
                    </div>
                </div>

                <!-- 自动备份设置 -->
                <div class="data-section mb-6" style="padding-top: 16px; border-top: 1px solid var(--border-color);">
                    <div class="section-subtitle" style="font-size: 14px; color: var(--text-secondary); margin-bottom: 12px; font-weight: 600;">💾 自动备份设置</div>
                    <div class="form-hint mb-3" style="font-size: 13px;">设置自动备份频率，防止数据丢失</div>
                    <div class="form-group mb-3">
                        <label class="form-label" style="font-size: 12px;">自动备份频率</label>
                        <select id="auto-backup-frequency" class="form-input" onchange="saveAutoBackupSettings()" style="font-size: 13px;">
                            <option value="never">不自动备份</option>
                            <option value="daily">每天</option>
                            <option value="weekly">每周</option>
                            <option value="monthly">每月</option>
                        </select>
                    </div>
                    <div class="form-group mb-3">
                        <label class="form-label" style="font-size: 12px;">备份保留数量</label>
                        <select id="auto-backup-keep" class="form-input" onchange="saveAutoBackupSettings()" style="font-size: 13px;">
                            <option value="3">保留3个备份</option>
                            <option value="5">保留5个备份</option>
                            <option value="10">保留10个备份</option>
                            <option value="30">保留30个备份</option>
                        </select>
                    </div>
                    <div class="form-group mb-3">
                        <label class="form-label" style="font-size: 12px;">上次备份</label>
                        <div id="last-backup-time" style="padding: 10px; background: var(--card-bg); border-radius: var(--radius-md); border: 1px solid var(--border-color); font-size: 13px; color: var(--text-secondary);">
                            从未备份
                        </div>
                    </div>
                    <div class="flex gap-3">
                        <button class="btn btn-primary flex-1" onclick="manualBackup()">💾 立即备份</button>
                        <button class="btn btn-secondary flex-1" onclick="showBackupHistory()">📋 备份历史</button>
                    </div>
                </div>

                <!-- 支出管理 -->
                <div class="data-section mb-6" style="padding-top: 16px; border-top: 1px solid var(--border-color);">
                    <div class="section-subtitle" style="font-size: 14px; color: var(--text-secondary); margin-bottom: 12px; font-weight: 600;">💰 支出管理</div>
                    <div class="form-group mb-2">
                        <label class="form-label" style="font-size: 12px;">待支出余额 (元)</label>
                        <input type="text" id="total-withdrawn" class="form-input" disabled style="font-size: 13px;">
                    </div>
                    <div class="form-group mb-2">
                        <label class="form-label" style="font-size: 12px;">支出金额</label>
                        <input type="number" id="expense-amount" class="form-input" placeholder="输入金额" step="0.01" style="font-size: 13px;">
                    </div>
                    <div class="form-group mb-2">
                        <label class="form-label" style="font-size: 12px;">支出用途</label>
                        <input type="text" id="expense-purpose" class="form-input" placeholder="输入用途" style="font-size: 13px;">
                    </div>
                    <div class="form-group mb-3">
                        <label class="form-label" style="font-size: 12px;">支出日期</label>
                        <input type="date" id="expense-date" class="form-input" style="font-size: 13px;">
                    </div>
                    <div class="flex gap-3">
                        <button class="btn btn-primary flex-1" onclick="addExpense()">💾 保存支出</button>
                        <button class="btn btn-secondary flex-1" onclick="showPage('expense-records')">📋 记录</button>
                    </div>
                </div>

                <!-- 危险操作 -->
                <div class="data-section" style="padding-top: 16px; border-top: 2px solid var(--error-color);">
                    <div class="section-subtitle" style="font-size: 14px; color: var(--error-color); margin-bottom: 12px; font-weight: 600;">⚠️ 危险操作</div>
                    <div class="form-hint mb-3" style="font-size: 13px; color: var(--error-color);">清空所有数据，此操作不可恢复！</div>
                    <button class="btn btn-error w-full" onclick="clearAllData()">🗑️ 清空所有数据</button>
                </div>
            </div>
        </div>

        <!-- 提现记录页面 -->
        <div class="page" id="page-withdraw-records">
            <div class="page-header">
                <button class="btn btn-secondary" onclick="showPage('phones')">返回</button>
                <div class="section-title">提现记录</div>
            </div>
            <div class="withdraw-records" id="withdraw-records-list">
                <div class="empty-state">暂无提现记录</div>
            </div>
        </div>

        <!-- 支出记录页面 -->
        <div class="page" id="page-expense-records">
            <div class="page-header">
                <button class="btn btn-secondary" onclick="showPage('settings')">返回</button>
                <div class="section-title">支出记录</div>
            </div>
            <div class="expense-records" id="expense-records-list">
                <div class="empty-state">暂无支出记录</div>
            </div>
        </div>

        <!-- 今日赚取页面 -->
        <div class="page" id="page-today-earn">
            <div class="page-header">
                <button class="btn btn-secondary" onclick="showPage('phones')">返回</button>
                <div class="section-title" id="today-earn-title">今日赚取</div>
            </div>
            
            <!-- 切换按钮 -->
            <div class="today-earn-tabs">
                <button class="today-earn-tab active" id="tab-phone-earn" onclick="switchTodayEarnTab('phone')">
                    📱 手机今日赚取
                </button>
                <button class="today-earn-tab" id="tab-app-earn" onclick="switchTodayEarnTab('app')">
                    📲 软件今日赚取
                </button>
            </div>
            
            <!-- 手机今日赚取内容 -->
            <div class="today-earn-content" id="phone-earn-content">
                <div class="today-earn-summary card">
                    <div class="summary-header">
                        <span class="summary-title">📊 每日赚取概览</span>
                    </div>
                    <div class="summary-stats">
                        <div class="summary-stat">
                            <span class="summary-label">今日目标</span>
                            <span class="summary-value" id="phone-daily-target">¥0.00</span>
                        </div>
                        <div class="summary-stat">
                            <span class="summary-label">今日已赚</span>
                            <span class="summary-value earned" id="phone-today-earned">¥0.00</span>
                        </div>
                        <div class="summary-stat">
                            <span class="summary-label">完成进度</span>
                            <span class="summary-value" id="phone-today-progress">0%</span>
                        </div>
                    </div>
                    <div class="summary-progress-bar">
                    <div class="summary-progress-fill" id="phone-progress-fill" style="width: 0%"></div>
                </div>
            </div>

            <div class="section-title mt-6">📅 每日赚取记录</div>
            <div class="earn-records-list" id="phone-earn-records">
                <div class="empty-state">暂无赚取记录</div>
            </div>
        </div>
            
            <!-- 软件今日赚取内容 -->
            <div class="today-earn-content hidden" id="app-earn-content">
                <div class="section-title">📅 软件每日收益记录</div>
                <div class="earn-records-list" id="app-earn-records">
                    <div class="empty-state">暂无软件赚取记录</div>
                </div>
            </div>
        </div>

        <!-- 分期还款管理页面 -->
        <div class="page" id="page-installments">
            <div class="date-container">
                <span class="current-date" id="installments-current-date"></span>
            </div>

            <div class="flex gap-4 w-full">
                <button class="btn btn-primary flex-1" onclick="openAddInstallmentModal()">添加分期</button>
                <button class="btn btn-secondary flex-1" onclick="openBatchAddInstallmentModal()">批量添加</button>
                <button class="btn btn-secondary flex-1" onclick="calculateInstallmentGoalsGlobal()">刷新计算</button>
            </div>

            <!-- 分期总览 -->
            <div class="card mt-6">
                <div class="section-header">
                    <div class="section-title">分期还款总览</div>
                    <div class="section-divider"></div>
                </div>
                <div class="stats-container">
                    <div class="stats-row">
                        <div class="stat-card border-primary">
                            <span class="stat-label">总还款金额</span>
                            <span class="stat-value" id="total-installment-amount">¥0.00</span>
                        </div>
                        <div class="stat-card border-secondary">
                            <span class="stat-label">最近还款日期</span>
                            <span class="stat-value" id="nearest-due-date">暂无</span>
                        </div>
                    </div>
                    <div class="stats-row">
                        <div class="stat-card border-tertiary">
                            <span class="stat-label">待支出金额</span>
                            <span class="stat-value" id="installment-earned">¥0.00</span>
                        </div>
                        <div class="stat-card border-accent">
                            <span class="stat-label">待提现金额</span>
                            <span class="stat-value" id="installment-needed">¥0.00</span>
                        </div>
                    </div>
                    <div class="stats-row">
                        <div class="stat-card" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
                            <span class="stat-label" style="color: rgba(255,255,255,0.9);">每日需赚取</span>
                            <span class="stat-value" style="color: white;" id="daily-earn-needed">¥0.00</span>
                        </div>
                        <div class="stat-card" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white;">
                            <span class="stat-label" style="color: rgba(255,255,255,0.9);">剩余天数</span>
                            <span class="stat-value" style="color: white;" id="installment-days-left">0天</span>
                        </div>
                    </div>
                </div>
                <div class="progress-item">
                    <div class="progress-header">
                        <span>总体进度</span>
                        <span class="font-semibold" id="installment-overall-progress">0%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="installment-progress-bar" style="width: 0%"></div>
                    </div>
                </div>
                
            </div>

            <!-- 分期列表 -->
            <div class="section-title mt-6">分期还款计划</div>
            <div class="installment-list" id="installment-list">
                <div class="empty-state">暂无分期记录</div>
            </div>
        </div>
    </main>

    <!-- 底部导航 -->
    <nav class="tab-bar">
        <div class="tab-item active" data-page="dashboard" onclick="showPage('dashboard')">
            <span class="tab-icon">📊</span>
            <span class="tab-text">仪表盘</span>
        </div>
        <div class="tab-item" data-page="phones" onclick="showPage('phones')">
            <span class="tab-icon">📱</span>
            <span class="tab-text">手机管理</span>
        </div>
        <div class="tab-item" data-page="stats" onclick="showPage('stats')">
            <span class="tab-icon">📈</span>
            <span class="tab-text">统计分析</span>
        </div>
        <div class="tab-item" data-page="installments" onclick="showPage('installments')">
            <span class="tab-icon">💳</span>
            <span class="tab-text">分期还款</span>
        </div>
        <div class="tab-item" data-page="forecast" onclick="showPage('forecast')">
            <span class="tab-icon">🎯</span>
            <span class="tab-text">提前计算</span>
        </div>
        <div class="tab-item" data-page="games" onclick="showPage('games')">
            <span class="tab-icon">🎮</span>
            <span class="tab-text">游戏管理</span>
        </div>
        <div class="tab-item" data-page="settings" onclick="showPage('settings')">
            <span class="tab-icon">⚙️</span>
            <span class="tab-text">设置</span>
        </div>
    </nav>

    <!-- 模态框 -->
    <div class="modal" id="modal" style="display: none;">
        <div class="modal-content" onclick="event.stopPropagation()">
            <div class="modal-title" id="modal-title">标题</div>
            <div class="modal-body" id="modal-body"></div>
            <div class="modal-buttons" id="modal-buttons"></div>
        </div>
    </div>

    <!-- 游戏抽签弹窗 -->
    <div class="game-draw-modal" id="game-draw-modal" style="display: none;">
        <div class="game-draw-modal-content" onclick="event.stopPropagation()">
            <div class="modal-title">🎮 游戏抽签</div>
            <div class="game-draw-body" id="game-draw-body">
                <!-- 游戏管理区域 -->
                <div class="game-manage-section" id="game-manage-section">
                    <div class="section-subtitle">管理游戏列表</div>
                    <div class="game-list" id="game-list"></div>
                    <div class="game-add-form">
                        <input type="text" id="draw-game-name" class="form-input" placeholder="输入游戏名称">
                        <button class="btn btn-primary" onclick="addGame()">添加游戏</button>
                    </div>
                </div>
                
                <!-- 抽签结果区域 -->
                <div class="game-draw-result-section hidden" id="game-draw-result-section">
                    <div class="draw-result-title">🎯 今日游戏任务</div>
                    <div class="draw-date" id="draw-date"></div>
                    <div class="game-draw-list" id="game-draw-list"></div>
                </div>
                
                <!-- 历史记录区域 -->
                <div class="game-history-section" id="game-history-section">
                    <div class="section-subtitle">📜 历史记录</div>
                    <div class="game-history-list" id="game-history-list"></div>
                </div>
            </div>
            <div class="modal-buttons">
                <button class="btn btn-secondary" onclick="closeGameDrawModal()">关闭</button>
                <button class="btn btn-primary" id="game-draw-btn" onclick="startGameDraw()">开始抽签</button>
            </div>
        </div>
    </div>

    <!-- 抽签结果弹窗 -->
    <div class="game-result-popup" id="game-result-popup" style="display: none;">
        <div class="game-result-popup-content" onclick="event.stopPropagation()">
            <div class="game-result-header">
                <div class="game-result-title">🎮 今日游戏任务</div>
                <div class="game-result-date" id="popup-draw-date"></div>
            </div>
            <div class="game-result-body" id="popup-game-result-list"></div>
            <div class="game-result-footer">
                <button class="btn btn-secondary" onclick="closeGameResultPopup()">关闭</button>
                <button class="btn btn-primary" onclick="startGameDraw()">重新抽签</button>
            </div>
        </div>
    </div>

    <!-- 手机抽签弹窗 -->
    <div class="game-draw-modal" id="phone-draw-modal" style="display: none;">
        <div class="game-draw-modal-content" onclick="event.stopPropagation()">
            <div class="modal-title">📱 手机抽签</div>
            <div class="game-draw-body" id="phone-draw-body">
                <!-- 手机抽签结果区域 -->
                <div class="game-draw-result-section" id="phone-draw-result-section">
                    <div class="draw-result-title">🎯 今日玩机顺序</div>
                    <div class="draw-date" id="phone-draw-date"></div>
                    <div class="game-draw-list" id="phone-draw-list"></div>
                </div>
                
                <!-- 历史记录区域 -->
                <div class="game-history-section" id="phone-draw-history-section">
                    <div class="section-subtitle">📜 抽签历史</div>
                    <div class="game-history-list" id="phone-draw-history-list"></div>
                </div>
            </div>
            <div class="modal-buttons">
                <button class="btn btn-secondary" onclick="closePhoneDrawModal()">关闭</button>
                <button class="btn btn-primary" id="phone-draw-btn" onclick="startPhoneDraw()">开始抽签</button>
            </div>
        </div>
    </div>

    <!-- 提示消息 -->
    <div class="toast" id="toast" style="display: none;"></div>

    <script src="app.js"></script>
</body>
</html>
